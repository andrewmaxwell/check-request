{"version":3,"sources":["utils.js","RenderFields.js","submit.js","loadState.js","App.js","runUpdaters.js","index.js"],"names":["adjust","index","func","arr","copy","remove","splice","fieldRenderers","select","label","value","error","options","onChange","FormControl","fullWidth","InputLabel","Select","map","o","MenuItem","FormHelperText","text","type","props","TextField","helperText","rows","blankRow","row","i","Grid","container","item","spacing","fields","updateRow","target","sm","Button","sx","width","height","onClick","calculated","formatter","x","Typography","Field","hide","Input","RenderFields","children","Object","entries","key","field","p","xs","columns","e","s","undefined","isVisible","isInvalid","String","trim","length","isEmpty","Array","isArray","some","values","addValidationErrors","obj","res","fieldsToStr","filter","join","submit","state","setState","date","Date","toLocaleString","fieldStr","body","encodeURIComponent","window","open","dollarFormatter","val","Number","getAccounts","a","fetch","response","split","r","loadState","multiline","account","explanation","amount","list","update","reduce","b","total","checkDelivery","address","requestorName","makeCheckPayableTo","App","useState","useEffect","then","node","updates","runUpdaters","Container","maxWidth","variant","Box","style","position","right","bottom","font","href","display","justifyContent","padding","CircularProgress","size","ReactDOM","render","StrictMode","document","querySelector"],"mappings":"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","file":"static/js/main.3c238a3a.chunk.js","sourcesContent":["export const adjust = (index, func, arr) => {\n  const copy = [...arr];\n  copy[index] = func(copy[index]);\n  return copy;\n};\n\nexport const remove = (index, arr) => {\n  const copy = [...arr];\n  copy.splice(index, 1);\n  return copy;\n};\n\nexport const sum = (arr) => arr?.reduce((a, b) => a + (Number(b) || 0), 0);\n\nexport const map = (func, obj) => {\n  const res = Array.isArray(obj) ? [] : {};\n  for (const key in obj) {\n    res[key] = func(obj[key], key);\n  }\n  return res;\n};\n","import React from \"react\";\nimport {\n  Button,\n  FormControl,\n  FormHelperText,\n  Grid,\n  InputLabel,\n  MenuItem,\n  Select,\n  TextField,\n  Typography,\n} from \"@mui/material\";\nimport { adjust, remove } from \"./utils\";\n\nconst fieldRenderers = {\n  select: ({ label, value = \"\", error, options, onChange }) => (\n    <FormControl fullWidth error={!!error}>\n      <InputLabel>{label}</InputLabel>\n      <Select label={label} onChange={onChange} value={value}>\n        {options.map((o) => (\n          <MenuItem key={o} value={o}>\n            {o}\n          </MenuItem>\n        ))}\n      </Select>\n      {error && <FormHelperText>{error}</FormHelperText>}\n    </FormControl>\n  ),\n\n  text: ({ label, type, error, value = \"\", onChange, props }) => (\n    <TextField\n      fullWidth\n      error={!!error}\n      helperText={error}\n      {...{ label, type, value, onChange, ...props }}\n    />\n  ),\n\n  rows: ({ blankRow, value, onChange }) => (\n    <>\n      {value.map((row, i) => (\n        <Grid container item key={i} spacing={1}>\n          <RenderFields\n            fields={row}\n            onChange={(updateRow) => {\n              onChange({ target: { value: adjust(i, updateRow, value) } });\n            }}\n          >\n            <Grid item sm={1}>\n              <Button\n                sx={{ width: \"100%\", height: \"100%\" }}\n                onClick={() =>\n                  onChange({ target: { value: remove(i, value) } })\n                }\n              >\n                Delete\n              </Button>\n            </Grid>\n          </RenderFields>\n        </Grid>\n      ))}\n\n      <Button\n        onClick={() => onChange({ target: { value: [...value, blankRow] } })}\n      >\n        Add Row\n      </Button>\n    </>\n  ),\n\n  calculated: ({ label, value, formatter = (x) => x }) => (\n    <Typography>\n      <strong>\n        {label}: {formatter(value)}\n      </strong>\n    </Typography>\n  ),\n};\n\nconst Field = (props) => {\n  if (props.hide) return null;\n  const Input = fieldRenderers[props.type] || fieldRenderers.text;\n  return <Input {...props} />;\n};\n\nexport const RenderFields = ({ fields, onChange, children }) => (\n  <Grid container>\n    {Object.entries(fields).map(([key, field]) => (\n      <Grid item key={key} p={1} xs={12} sm={field.columns}>\n        <Field\n          {...field}\n          onChange={(e) => {\n            onChange((s) => ({\n              ...s,\n              [key]: { ...s[key], value: e.target.value, error: undefined },\n            }));\n          }}\n        />\n      </Grid>\n    ))}\n    {children}\n  </Grid>\n);\n","import { map } from \"./utils\";\n\nconst isVisible = ({ hide }) => !hide;\n\nconst isEmpty = (val = \"\") => !String(val).trim().length;\n\nconst isInvalid = (field) =>\n  isVisible(field) &&\n  (isEmpty(field.value) ||\n    (Array.isArray(field.value) &&\n      field.value.some((row) => Object.values(row).some(isInvalid))));\n\nconst addValidationErrors = (obj) =>\n  map(\n    (field) =>\n      Array.isArray(field.value)\n        ? { ...field, value: field.value.map(addValidationErrors) }\n        : { ...field, error: isInvalid(field) && \"Required\" },\n    obj\n  );\n\nconst fieldsToStr = (obj) =>\n  Object.values(obj)\n    .filter(isVisible)\n    .map(({ label, value, formatter = (x) => x }) =>\n      Array.isArray(value)\n        ? `\\r\\n${value.map((row) => fieldsToStr(row)).join(\"\\r\\n\\r\\n\")}\\r\\n`\n        : `${label}: ${formatter(value)}`\n    )\n    .join(\"\\r\\n\");\n\nexport const submit = (state, setState) => {\n  if (Object.values(state).some(isInvalid)) {\n    setState(addValidationErrors);\n    return;\n  }\n  const date = new Date().toLocaleString();\n  const fieldStr = fieldsToStr(state);\n  const body = encodeURIComponent(\n    `Date: ${date}\\r\\n${fieldStr}\\r\\n\\r\\nREMINDER: Attach relevant files.`\n  );\n  window.open(\n    `mailto:chatham.ap@gmail.com?cc=chathamit@chathambiblechurch.org&subject=Check Request&body=${body}`\n  );\n};\n","import { sum } from \"./utils\";\n\nconst dollarFormatter = (val) => \"$\" + Number(val).toLocaleString();\n\nconst getAccounts = async () => {\n  const response = await fetch(\n    \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQBAv7s2hKsbFKPuv8qZ8z0rAgsE_5ZPwP8rGY527yIfMLjOs9Foy-Z4Tj54SFYti7I4QvTYnmQQIQa/pub?output=tsv\"\n  );\n  const text = await response.text();\n  return text?.split(\"\\n\").map((r) => r.trim());\n};\n\nexport const loadState = async () => ({\n  requestorName: { label: \"Requestor Name\", type: \"text\", columns: 6 },\n  makeCheckPayableTo: {\n    label: \"Make Check Payable To\",\n    type: \"text\",\n    columns: 6,\n  },\n  list: {\n    label: \"list\",\n    type: \"rows\",\n    blankRow: {\n      account: {\n        label: \"Account\",\n        type: \"select\",\n        columns: 4,\n        options: await getAccounts(),\n      },\n      explanation: {\n        label: \"Explanation\",\n        type: \"text\",\n        columns: 5,\n        props: { multiline: true },\n      },\n      amount: {\n        label: \"Amount\",\n        type: \"number\",\n        columns: 2,\n        formatter: dollarFormatter,\n      },\n    },\n    update: (state) =>\n      !state.list.value?.length && { value: [state.list.blankRow] },\n  },\n  total: {\n    label: \"Total\",\n    type: \"calculated\",\n    formatter: dollarFormatter,\n    update: (state) => {\n      const value = sum(state.list.value?.map((row) => row.amount.value));\n      return value !== state.total.value && { value };\n    },\n  },\n  checkDelivery: {\n    label: \"Check Delivery\",\n    type: \"select\",\n    columns: 6,\n    options: [\n      \"Mail Check\",\n      \"Give Check to Requestor\",\n      \"Place Check in Requestor's Folder\",\n    ],\n  },\n  address: {\n    label: \"Address\",\n    type: \"text\",\n    columns: 6,\n    update: (state) => {\n      const hide = state.checkDelivery.value !== \"Mail Check\";\n      return state.address.hide !== hide && { hide };\n    },\n  },\n});\n","import React, { useEffect, useState } from \"react\";\nimport {\n  Box,\n  Typography,\n  Button,\n  CircularProgress,\n  Container,\n} from \"@mui/material\";\nimport { RenderFields } from \"./RenderFields.js\";\nimport { submit } from \"./submit.js\";\nimport { loadState } from \"./loadState.js\";\nimport { runUpdaters } from \"./runUpdaters.js\";\n\n/* \nPossible Future Features: \n- Send to Ministry Leader for approval when total > $250\n\n*/\n\nexport default function App() {\n  const [state, setState] = useState();\n\n  useEffect(() => {\n    loadState().then(setState);\n  }, []);\n\n  if (!state) {\n    return (\n      <Box sx={{ display: \"flex\", justifyContent: \"center\", padding: 20 }}>\n        <CircularProgress size={100} />\n      </Box>\n    );\n  }\n\n  runUpdaters(state, setState);\n\n  return (\n    <Container maxWidth=\"md\">\n      <Typography p={1} variant=\"h4\">\n        Check Request Form\n      </Typography>\n\n      <RenderFields fields={state} onChange={setState} />\n\n      <Typography p={1}>\n        Pressing &quot;Submit&quot; will create an email ready to be sent.\n      </Typography>\n\n      <Typography p={1}>\n        <strong>\n          Please attach any necessary documents or receipts to the email before\n          sending.\n        </strong>\n      </Typography>\n\n      <Box p={1}>\n        <Button variant=\"contained\" onClick={() => submit(state, setState)}>\n          Submit\n        </Button>\n      </Box>\n\n      <Typography p={1}>\n        When you have sent the email, you may close this page.\n      </Typography>\n\n      <a\n        style={{\n          position: \"fixed\",\n          right: 2,\n          bottom: 2,\n          font: \"12px sans-serif\",\n        }}\n        href=\"mailto:chathamit@chathambiblechurch.org?subject=Check Request Bug Report\"\n      >\n        Report a Problem\n      </a>\n    </Container>\n  );\n}\n","export const runUpdaters = (state, setState) => {\n  for (const key in state) {\n    const node = state[key];\n    // to support updaters in deeper fields, do this...\n    // const { value, update } = node;\n    // for (let i = 0; i < value?.length; i++) {\n    //   runUpdaters(value[i], (updateRow) =>\n    //     setState((s) => ({\n    //       ...s,\n    //       [key]: { ...s[key], value: adjust(i, updateRow, s[key].value) },\n    //     }))\n    //   );\n    // }\n\n    // to handle async updaters, do this...\n    // const callback = (updates) =>\n    //   updates && setState((s) => ({ ...s, [key]: { ...s[key], ...updates } }));\n    // callback(update?.(state, callback));\n\n    const updates = node.update?.(state);\n    if (updates) setState((s) => ({ ...s, [key]: { ...s[key], ...updates } }));\n  }\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.querySelector(\"#root\")\n);\n"],"sourceRoot":""}