{"version":3,"sources":["utils.js","RenderFields.js","submit.js","loadState.js","runUpdaters.js","App.js","index.js"],"names":["adjust","index","func","arr","copy","remove","splice","map","obj","res","Array","isArray","key","fieldRenderers","select","label","value","error","options","onChange","FormControl","fullWidth","InputLabel","Select","o","MenuItem","FormHelperText","text","type","props","TextField","helperText","repeatingSection","fields","row","i","Grid","container","item","spacing","updateRow","target","sm","Button","sx","width","height","onClick","calculated","formatter","Typography","Field","hide","Input","RenderFields","children","Object","entries","field","p","xs","columns","e","s","undefined","isVisible","isInvalid","String","trim","length","isEmpty","some","values","addValidationErrors","fieldsToStr","filter","join","submit","setFields","emailReminder","emailTo","emailSubject","date","Date","toLocaleString","fieldStr","body","encodeURIComponent","window","open","formatters","dollars","val","Number","makeFunction","args","Function","loadState","a","fetch","location","hash","slice","resp","XLSX","utils","sheet_to_json","arrayBuffer","read","Sheets","data","console","log","f","update","format","x","parentField","fromEntries","config","r","runUpdaters","node","updates","App","useState","state","setState","useEffect","then","useCallback","updateFields","Container","maxWidth","variant","formTitle","dangerouslySetInnerHTML","__html","beforeButtonHtml","Box","submitLabel","afterButtonHtml","style","position","right","bottom","font","href","display","justifyContent","padding","CircularProgress","size","ReactDOM","render","StrictMode","document","querySelector"],"mappings":"qVAAaA,EAAS,SAACC,EAAOC,EAAMC,GAClC,IAAMC,EAAI,YAAOD,GAEjB,OADAC,EAAKH,GAASC,EAAKE,EAAKH,IACjBG,GAGIC,EAAS,SAACJ,EAAOE,GAC5B,IAAMC,EAAI,YAAOD,GAEjB,OADAC,EAAKE,OAAOL,EAAO,GACZG,GAGIG,EAAM,SAACL,EAAMM,GACxB,IAAMC,EAAMC,MAAMC,QAAQH,GAAO,GAAK,GACtC,IAAK,IAAMI,KAAOJ,EAChBC,EAAIG,GAAOV,EAAKM,EAAII,GAAMA,GAE5B,OAAOH,G,OCHHI,EAAiB,CACrBC,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,IAAUC,aAAV,MAAkB,GAAlB,EAAsBC,EAAtB,EAAsBA,MAAOC,EAA7B,EAA6BA,QAASC,EAAtC,EAAsCA,SAAtC,OACN,eAACC,EAAA,EAAD,CAAaC,WAAS,EAACJ,QAASA,EAAhC,UACE,cAACK,EAAA,EAAD,UAAaP,IACb,cAACQ,EAAA,EAAD,CAAQR,MAAOA,EAAOI,SAAUA,EAAUH,MAAOA,EAAjD,SACGE,EAAQX,KAAI,SAACiB,GAAD,OACX,cAACC,EAAA,EAAD,CAAkBT,MAAOQ,EAAzB,SACGA,GADYA,QAKlBP,GAAS,cAACS,EAAA,EAAD,UAAiBT,QAI/BU,KAAM,gBAAGZ,EAAH,EAAGA,MAAOa,EAAV,EAAUA,KAAMX,EAAhB,EAAgBA,MAAhB,IAAuBD,aAAvB,MAA+B,GAA/B,EAAmCG,EAAnC,EAAmCA,SAAUU,EAA7C,EAA6CA,MAA7C,OACJ,cAACC,EAAA,EAAD,aACET,WAAS,EACTJ,QAASA,EACTc,WAAYd,GAHd,aAIQF,QAAOa,OAAMZ,QAAOG,YAAaU,MAI3CG,iBAAkB,gBAAGC,EAAH,EAAGA,OAAQjB,EAAX,EAAWA,MAAOG,EAAlB,EAAkBA,SAAlB,OAChB,qCACGH,EAAMT,KAAI,SAAC2B,EAAKC,GAAN,OACT,cAACC,EAAA,EAAD,CAAMC,WAAS,EAACC,MAAI,EAASC,QAAS,EAAtC,SACE,cAAC,EAAD,CACEN,OAAQC,EACRf,SAAU,SAACqB,GACTrB,EAAS,CAAEsB,OAAQ,CAAEzB,MAAOhB,EAAOmC,EAAGK,EAAWxB,OAHrD,SAME,cAACoB,EAAA,EAAD,CAAME,MAAI,EAACI,GAAI,EAAf,SACE,cAACC,EAAA,EAAD,CACEC,GAAI,CAAEC,MAAO,OAAQC,OAAQ,QAC7BC,QAAS,kBACP5B,EAAS,CAAEsB,OAAQ,CAAEzB,MAAOX,EAAO8B,EAAGnB,OAH1C,yBARoBmB,MAqB5B,cAACQ,EAAA,EAAD,CACEI,QAAS,kBAAM5B,EAAS,CAAEsB,OAAQ,CAAEzB,MAAM,GAAD,mBAAMA,GAAN,CAAaiB,QADxD,yBAQJe,WAAY,gBAAGjC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,MAAOiC,EAAjB,EAAiBA,UAAjB,OACV,cAACC,EAAA,EAAD,UACE,mCACGnC,EADH,KACYkC,EAAUjC,UAMtBmC,EAAQ,SAACtB,GACb,GAAIA,EAAMuB,KAAM,OAAO,KACvB,IAAMC,EAAQxC,EAAegB,EAAMD,OAASf,EAAec,KAC3D,OAAO,cAAC0B,EAAD,eAAWxB,KAGPyB,EAAe,SAAC,GAAD,IAAGrB,EAAH,EAAGA,OAAQd,EAAX,EAAWA,SAAUoC,EAArB,EAAqBA,SAArB,OAC1B,eAACnB,EAAA,EAAD,CAAMC,WAAS,EAAf,UACGmB,OAAOC,QAAQxB,GAAQ1B,KAAI,mCAAEK,EAAF,KAAO8C,EAAP,YAC1B,cAACtB,EAAA,EAAD,CAAME,MAAI,EAAWqB,EAAG,EAAGC,GAAI,GAAIlB,GAAIgB,EAAMG,QAA7C,SACE,cAAC,EAAD,2BACMH,GADN,IAEEvC,SAAU,SAAC2C,GACT3C,GAAS,SAAC4C,GAAD,mBAAC,eACLA,GADI,kBAENnD,EAFM,YAAC,eAEImD,EAAEnD,IAFP,IAEaI,MAAO8C,EAAErB,OAAOzB,MAAOC,WAAO+C,cAN1CpD,MAYjB2C,MClGCU,EAAY,SAAC,GAAD,SAAGb,MAIfc,EAAY,SAAZA,EAAaR,GAAD,OAChBO,EAAUP,KAHI,kBAAeS,OAAf,uDAAO,IAAoBC,OAAOC,OAI/CC,CAAQZ,EAAM1C,QACZN,MAAMC,QAAQ+C,EAAM1C,QACnB0C,EAAM1C,MAAMuD,MAAK,SAACrC,GAAD,OAASsB,OAAOgB,OAAOtC,GAAKqC,KAAKL,QAElDO,EAAsB,SAAtBA,EAAuBjE,GAAD,OAC1BD,GACE,SAACmD,GAAD,OACEhD,MAAMC,QAAQ+C,EAAM1C,OAApB,2BACS0C,GADT,IACgB1C,MAAO0C,EAAM1C,MAAMT,IAAIkE,KADvC,2BAESf,GAFT,IAEgBzC,MAAOiD,EAAUR,IAAU,eAC7ClD,IAGEkE,EAAc,SAAdA,EAAelE,GAAD,OAClBgD,OAAOgB,OAAOhE,GACXmE,OAAOV,GACP1D,KAAI,gBAAGQ,EAAH,EAAGA,MAAOC,EAAV,EAAUA,MAAOiC,EAAjB,EAAiBA,UAAjB,OACHvC,MAAMC,QAAQK,GAAd,cACWA,EAAMT,KAAI,SAAC2B,GAAD,OAASwC,EAAYxC,MAAM0C,KAAK,YADrD,kBAEO7D,EAFP,aAEiBkC,EAAUjC,OAE5B4D,KAAK,SAEGC,EAAS,SAAC,EAErBC,GACI,IAFF7C,EAEC,EAFDA,OAAQ8C,EAEP,EAFOA,cAAeC,EAEtB,EAFsBA,QAASC,EAE/B,EAF+BA,aAGlC,GAAIzB,OAAOgB,OAAOvC,GAAQsC,KAAKL,GAC7BY,EAAUL,OADZ,CAIA,IAAMS,GAAO,IAAIC,MAAOC,iBAClBC,EAAWX,EAAYzC,GACvBqD,EAAOC,mBAAmB,SAAD,OACpBL,EADoB,eACTG,EADS,mBACUN,IAEzCS,OAAOC,KAAP,iBAAsBT,EAAtB,oBAAyCC,EAAzC,iBAA8DK,M,0DCtC1DI,EAAa,CACjBC,QAAS,SAACC,GAAD,MAAS,IAAMC,OAAOD,GAAKR,mBAGhCU,EAAe,SAACC,EAAMT,GAAP,mBACfU,SADe,YAEdD,GAFc,sBAGVT,EAHU,6CAGgCA,EAHhC,uBAMRW,EAAS,uCAAG,wCAAAC,EAAA,sEACJC,MAAMC,SAASC,KAAKC,MAAM,IAb7C,mJAYuB,cACjBC,EADiB,YAEVhG,EAFU,KAGrBiG,IAAKC,MAAMC,cAHU,KAIrBF,IAJqB,SAILD,EAAKI,cAJA,6BAIhBC,KAJgB,gBAIeC,OAFhCC,GAFiB,mBAOvBC,QAAQC,IAAI,qBAAsBF,GAE5B7E,EAAS,GATQ,cAUP6E,EAAK7E,QAVE,IAUvB,2BAAWgF,EAAkB,QACrBzG,EADqB,aAEzBO,MAAOkG,EAAElG,MACTa,KAAMqF,EAAErF,KACRiC,QAASgC,OAAOoB,EAAEpD,UAAY,EAC9BqD,OAAQD,EAAEC,QAAUpB,EAAa,CAAC,UAAWmB,EAAEC,QAC/CjE,UAAWyC,EAAWuB,EAAEE,SAAY,SAACC,GAAD,OAAOA,GAC3CnF,OAAQ,IACJgF,EAAE/F,QAAU4E,EAAa,CAAC,QAASmB,EAAE/F,QAAzB4E,CAAkCgB,GAAQ,IAExDG,EAAEI,YAAapF,EAAOgF,EAAEI,aAAapF,OAAOgF,EAAErG,KAAOJ,EACpDyB,EAAOgF,EAAErG,KAAOJ,EArBA,kFAyBlBgD,OAAO8D,YAAYR,EAAKS,OAAOhH,KAAI,SAACiH,GAAD,MAAO,CAACA,EAAE5G,IAAK4G,EAAExG,YAzBlC,IA0BrBiB,YA1BqB,4CAAH,qDCdTwF,EAAc,SAAdA,EAAexF,EAAQ6C,GAAe,IAAD,WACrClE,GAGT,IAJ8C,MAExC8G,EAAOzF,EAAOrB,GAF0B,WAIrCuB,GACPsF,EAAYC,EAAK1G,MAAMmB,IAAI,SAACK,GAAD,OACzBsC,GAAU,SAACf,GAAD,mBAAC,eACNA,GADK,kBAEPnD,EAFO,YAAC,eAEGmD,EAAEnD,IAFN,IAEYI,MAAOhB,EAAOmC,EAAGK,EAAWuB,EAAEnD,GAAKI,kBAJpDmB,EAAI,EAAGA,GAAC,UAAGuF,EAAK1G,aAAR,aAAG,EAAYqD,QAAQlC,IAAK,CAAC,IAAD,IAApCA,GAST,IAAMwF,EAAO,UAAGD,EAAKR,cAAR,aAAG,OAAAQ,EAAczF,GAC1B0F,GAA8B,kBAAZA,GACpB7C,GAAU,SAACf,GAAD,mBAAC,eAAYA,GAAb,kBAAiBnD,EAAjB,YAAC,eAA2BmD,EAAEnD,IAAS+G,SAdrD,IAAK,IAAM/G,KAAOqB,EAAS,EAAhBrB,ICgBE,SAASgH,IACtB,MAA0BC,qBAA1B,mBAAOC,EAAP,KAAcC,EAAd,KAEAC,qBAAU,WACR/B,IAAYgC,KAAKF,KAChB,IAEH,IAAMjD,EAAYoD,uBAChB,SAACC,GAAD,OACEJ,GAAS,SAAChE,GAAD,mBAAC,eAAYA,GAAb,IAAgB9B,OAAQkG,EAAapE,EAAE9B,eAClD,IAGF,OAAK6F,GAQLL,EAAYK,EAAM7F,OAAQ6C,GAGxB,eAACsD,EAAA,EAAD,CAAWC,SAAS,KAApB,UACE,cAACnF,EAAA,EAAD,CAAYS,EAAG,EAAG2E,QAAQ,KAA1B,SACGR,EAAMS,YAGT,cAAC,EAAD,CAActG,OAAQ6F,EAAM7F,OAAQd,SAAU2D,IAE9C,cAAC5B,EAAA,EAAD,CACES,EAAG,EACH6E,wBAAyB,CAAEC,OAAQX,EAAMY,oBAG3C,cAACC,EAAA,EAAD,CAAKhF,EAAG,EAAR,SACE,cAAChB,EAAA,EAAD,CAAQ2F,QAAQ,YAAYvF,QAAS,kBAAM8B,EAAOiD,EAAOhD,IAAzD,SACGgD,EAAMc,gBAIX,cAAC1F,EAAA,EAAD,CACES,EAAG,EACH6E,wBAAyB,CAAEC,OAAQX,EAAMe,mBAG3C,mBACEC,MAAO,CACLC,SAAU,QACVC,MAAO,EACPC,OAAQ,EACRC,KAAM,mBAERC,KAAK,2EAPP,kCAhCA,cAACR,EAAA,EAAD,CAAK/F,GAAI,CAAEwG,QAAS,OAAQC,eAAgB,SAAUC,QAAS,IAA/D,SACE,cAACC,EAAA,EAAD,CAAkBC,KAAM,QC/BhCC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC/B,EAAD,MAEFgC,SAASC,cAAc,W","file":"static/js/main.48db1bc5.chunk.js","sourcesContent":["export const adjust = (index, func, arr) => {\n  const copy = [...arr];\n  copy[index] = func(copy[index]);\n  return copy;\n};\n\nexport const remove = (index, arr) => {\n  const copy = [...arr];\n  copy.splice(index, 1);\n  return copy;\n};\n\nexport const map = (func, obj) => {\n  const res = Array.isArray(obj) ? [] : {};\n  for (const key in obj) {\n    res[key] = func(obj[key], key);\n  }\n  return res;\n};\n","import React from \"react\";\nimport {\n  Button,\n  FormControl,\n  FormHelperText,\n  Grid,\n  InputLabel,\n  MenuItem,\n  Select,\n  TextField,\n  Typography,\n} from \"@mui/material\";\nimport { adjust, remove } from \"./utils\";\n\nconst fieldRenderers = {\n  select: ({ label, value = \"\", error, options, onChange }) => (\n    <FormControl fullWidth error={!!error}>\n      <InputLabel>{label}</InputLabel>\n      <Select label={label} onChange={onChange} value={value}>\n        {options.map((o) => (\n          <MenuItem key={o} value={o}>\n            {o}\n          </MenuItem>\n        ))}\n      </Select>\n      {error && <FormHelperText>{error}</FormHelperText>}\n    </FormControl>\n  ),\n\n  text: ({ label, type, error, value = \"\", onChange, props }) => (\n    <TextField\n      fullWidth\n      error={!!error}\n      helperText={error}\n      {...{ label, type, value, onChange, ...props }}\n    />\n  ),\n\n  repeatingSection: ({ fields, value, onChange }) => (\n    <>\n      {value.map((row, i) => (\n        <Grid container item key={i} spacing={1}>\n          <RenderFields\n            fields={row}\n            onChange={(updateRow) => {\n              onChange({ target: { value: adjust(i, updateRow, value) } });\n            }}\n          >\n            <Grid item sm={1}>\n              <Button\n                sx={{ width: \"100%\", height: \"100%\" }}\n                onClick={() =>\n                  onChange({ target: { value: remove(i, value) } })\n                }\n              >\n                Delete\n              </Button>\n            </Grid>\n          </RenderFields>\n        </Grid>\n      ))}\n\n      <Button\n        onClick={() => onChange({ target: { value: [...value, fields] } })}\n      >\n        Add Row\n      </Button>\n    </>\n  ),\n\n  calculated: ({ label, value, formatter }) => (\n    <Typography>\n      <strong>\n        {label}: {formatter(value)}\n      </strong>\n    </Typography>\n  ),\n};\n\nconst Field = (props) => {\n  if (props.hide) return null;\n  const Input = fieldRenderers[props.type] || fieldRenderers.text;\n  return <Input {...props} />;\n};\n\nexport const RenderFields = ({ fields, onChange, children }) => (\n  <Grid container>\n    {Object.entries(fields).map(([key, field]) => (\n      <Grid item key={key} p={1} xs={12} sm={field.columns}>\n        <Field\n          {...field}\n          onChange={(e) => {\n            onChange((s) => ({\n              ...s,\n              [key]: { ...s[key], value: e.target.value, error: undefined },\n            }));\n          }}\n        />\n      </Grid>\n    ))}\n    {children}\n  </Grid>\n);\n","import { map } from \"./utils\";\n\nconst isVisible = ({ hide }) => !hide;\n\nconst isEmpty = (val = \"\") => !String(val).trim().length;\n\nconst isInvalid = (field) =>\n  isVisible(field) &&\n  (isEmpty(field.value) ||\n    (Array.isArray(field.value) &&\n      field.value.some((row) => Object.values(row).some(isInvalid))));\n\nconst addValidationErrors = (obj) =>\n  map(\n    (field) =>\n      Array.isArray(field.value)\n        ? { ...field, value: field.value.map(addValidationErrors) }\n        : { ...field, error: isInvalid(field) && \"Required\" },\n    obj\n  );\n\nconst fieldsToStr = (obj) =>\n  Object.values(obj)\n    .filter(isVisible)\n    .map(({ label, value, formatter }) =>\n      Array.isArray(value)\n        ? `\\r\\n${value.map((row) => fieldsToStr(row)).join(\"\\r\\n\\r\\n\")}\\r\\n`\n        : `${label}: ${formatter(value)}`\n    )\n    .join(\"\\r\\n\");\n\nexport const submit = (\n  { fields, emailReminder, emailTo, emailSubject },\n  setFields\n) => {\n  if (Object.values(fields).some(isInvalid)) {\n    setFields(addValidationErrors);\n    return;\n  }\n  const date = new Date().toLocaleString();\n  const fieldStr = fieldsToStr(fields);\n  const body = encodeURIComponent(\n    `Date: ${date}\\r\\n${fieldStr}\\r\\n\\r\\n${emailReminder}`\n  );\n  window.open(`mailto:${emailTo}&subject=${emailSubject}&body=${body}`);\n};\n","import { map } from \"./utils\";\nimport XLSX from \"xlsx\";\n\nconst spreadSheetUrl =\n  \"https://docs.google.com/spreadsheets/d/e/2PACX-1vRqtLRKclmmHXDiJjAslERNMniAlL0VKDvvWrj7njfiEOLAyM_HAKP-pzPrErqA0T9N2-PvkrUTG9Zy/pub?output=xlsx\";\n\nconst formatters = {\n  dollars: (val) => \"$\" + Number(val).toLocaleString(),\n};\n\nconst makeFunction = (args, body) =>\n  new Function(\n    ...args,\n    `try{${body}}catch(e){console.error(\\`Error in ${body})\\`, e.message)}`\n  );\n\nexport const loadState = async () => {\n  const resp = await fetch(location.hash.slice(1) || spreadSheetUrl);\n  const data = map(\n    XLSX.utils.sheet_to_json,\n    XLSX.read(await resp.arrayBuffer()).Sheets\n  );\n\n  console.log(\"unprocessed config\", data);\n\n  const fields = {};\n  for (const f of data.fields) {\n    const obj = {\n      label: f.label,\n      type: f.type,\n      columns: Number(f.columns) || 0,\n      update: f.update && makeFunction([\"fields\"], f.update),\n      formatter: formatters[f.format] || ((x) => x),\n      fields: {},\n      ...(f.options ? makeFunction([\"data\"], f.options)(data) : {}),\n    };\n    if (f.parentField) fields[f.parentField].fields[f.key] = obj;\n    else fields[f.key] = obj;\n  }\n\n  return {\n    ...Object.fromEntries(data.config.map((r) => [r.key, r.value])),\n    fields,\n  };\n};\n","import { adjust } from \"./utils\";\n\nexport const runUpdaters = (fields, setFields) => {\n  for (const key in fields) {\n    const node = fields[key];\n\n    for (let i = 0; i < node.value?.length; i++) {\n      runUpdaters(node.value[i], (updateRow) =>\n        setFields((s) => ({\n          ...s,\n          [key]: { ...s[key], value: adjust(i, updateRow, s[key].value) },\n        }))\n      );\n    }\n\n    const updates = node.update?.(fields);\n    if (updates && typeof updates === \"object\")\n      setFields((s) => ({ ...s, [key]: { ...s[key], ...updates } }));\n  }\n};\n","import React, { useEffect, useState, useCallback } from \"react\";\nimport {\n  Box,\n  Typography,\n  Button,\n  CircularProgress,\n  Container,\n} from \"@mui/material\";\nimport { RenderFields } from \"./RenderFields.js\";\nimport { submit } from \"./submit.js\";\nimport { loadState } from \"./loadState.js\";\nimport { runUpdaters } from \"./runUpdaters.js\";\n\n/* \nPossible Future Features: \n- Send to respective ministry leaders for approval when total > $250\n- Store form configuration in a google spreadsheet\n*/\n\nexport default function App() {\n  const [state, setState] = useState();\n\n  useEffect(() => {\n    loadState().then(setState);\n  }, []);\n\n  const setFields = useCallback(\n    (updateFields) =>\n      setState((s) => ({ ...s, fields: updateFields(s.fields) })),\n    []\n  );\n\n  if (!state) {\n    return (\n      <Box sx={{ display: \"flex\", justifyContent: \"center\", padding: 20 }}>\n        <CircularProgress size={100} />\n      </Box>\n    );\n  }\n\n  runUpdaters(state.fields, setFields);\n\n  return (\n    <Container maxWidth=\"md\">\n      <Typography p={1} variant=\"h4\">\n        {state.formTitle}\n      </Typography>\n\n      <RenderFields fields={state.fields} onChange={setFields} />\n\n      <Typography\n        p={1}\n        dangerouslySetInnerHTML={{ __html: state.beforeButtonHtml }}\n      ></Typography>\n\n      <Box p={1}>\n        <Button variant=\"contained\" onClick={() => submit(state, setFields)}>\n          {state.submitLabel}\n        </Button>\n      </Box>\n\n      <Typography\n        p={1}\n        dangerouslySetInnerHTML={{ __html: state.afterButtonHtml }}\n      ></Typography>\n\n      <a\n        style={{\n          position: \"fixed\",\n          right: 2,\n          bottom: 2,\n          font: \"12px sans-serif\",\n        }}\n        href=\"mailto:chathamit@chathambiblechurch.org?subject=Check Request Bug Report\"\n      >\n        Report a Problem\n      </a>\n    </Container>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.querySelector(\"#root\")\n);\n"],"sourceRoot":""}